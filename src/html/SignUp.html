<!DOCTYPE html>
<html lang="es">
   <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="../css/SignUp.css">
    <title>Sign Up</title>
    </head>
    <body>
        <div class="green"></div>
        <div class="cuadrado">
            <img src="../css/logo.png">   
            <form action="index.html">
                    
                <div class="txtb">
                    <label for="subject">Nombre</label>
                    <input type="text" id="name" name="name">
                </div>

                <div class="txtb">
                    <p>Apellido</p>
                    <input type="text" id="lastName" name="lastName">
                </div>

                <div class="txtb">
                    <p>eMail</p>
                    <input type="text" id="email" name="email">
                </div>

                <div class="txtb">
                    <p>Contrase√±a</p>
                    <input type="password" id="password" name="password">
                </div>  
                <div class="txtb">
                    <p>Codigo</p>
                    <input type="text" id="codigo" name="codigo">
                </div>                  
                
            </form>
        </div>            
        <input type="button" id="Submit" value="Regristrarse" class="sub" onclick="addUser()">
    </body>
       
   
   <script type="text/javascript" src="../js/Usuario.js">
        function addUser(){
            console.log("BOTON APACHADO")
            var firstName = document.getElementById('name').value;
            var lastName = document.getElementById('lastName').value;
            var email = document.getElementById('email').value;
            var password = document.getElementById('password').value;
            console.log('got the values, attepmtping db insert');

            Users.count({where: {email: email}}).then(c => {
                if(c == 0 && firstName != "" && lastName != "" && email != "" && password != ""){
                    Users.create({
                        first_name: firstName,
                        last_name: lastName,
                        email: email,
                        password: password,
                        type: 'admin'
                    });
                    alert("Usuario creado con exito.")
                    window.location="../html/login.html"
                }
                else{

                    throw error
                }
                return c
            }).catch(err => {
                return err;
            })

            
        }
    </script>
</html>
